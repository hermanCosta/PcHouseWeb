@using PcHouseStore.Web.Services
@inject CompanyContext CompanyContext
@inject NavigationManager Navigation

<div class="top-row ps-3 navbar navbar-dark">
    <div class="container-fluid">
        <a class="navbar-brand pchouse-logo" href="">
            <span class="pchouse-icon">ðŸ’»</span>
            PcHouse Store
        </a>
        @if (CompanyContext.IsAuthenticated)
        {
            <div class="company-info">
                <span class="company-name">@GetCompanyDisplayName()</span>
                <button class="btn-logout" @onclick="Logout" title="Logout">
                    <span class="oi oi-account-logout"></span>
                </button>
            </div>
        }
        <button title="Navigation menu" class="navbar-toggler" @onclick="ToggleNavMenu">
            <span class="navbar-toggler-icon"></span>
        </button>
    </div>
</div>

<div class="@NavMenuCssClass" @onclick="ToggleNavMenu">
    <nav class="flex-column">
        <div class="nav-item px-3">
            <NavLink class="nav-link" href="" Match="NavLinkMatch.All">
                <span class="oi oi-home" aria-hidden="true"></span> Home
            </NavLink>
        </div>
        <div class="nav-item px-3">
            <NavLink class="nav-link" href="dashboard">
                <span class="oi oi-dashboard" aria-hidden="true"></span> Dashboard
            </NavLink>
        </div>
        <div class="nav-item px-3">
            <NavLink class="nav-link" href="sales">
                <span class="oi oi-cart" aria-hidden="true"></span> Sales
            </NavLink>
        </div>
        <div class="nav-item px-3">
            <NavLink class="nav-link" href="service-orders">
                <span class="oi oi-wrench" aria-hidden="true"></span> Service Orders
            </NavLink>
        </div>
        <div class="nav-item px-3">
            <NavLink class="nav-link" href="products">
                <span class="oi oi-box" aria-hidden="true"></span> Products
            </NavLink>
        </div>
        <div class="nav-item px-3">
            <NavLink class="nav-link" href="customers">
                <span class="oi oi-people" aria-hidden="true"></span> Customers
            </NavLink>
        </div>
        <div class="nav-item px-3">
            <NavLink class="nav-link" href="companies">
                <span class="oi oi-building" aria-hidden="true"></span> Companies
            </NavLink>
        </div>
        <div class="nav-item px-3">
            <NavLink class="nav-link" href="counter">
                <span class="oi oi-plus" aria-hidden="true"></span> Counter
            </NavLink>
        </div>
        <div class="nav-item px-3">
            <NavLink class="nav-link" href="fetchdata">
                <span class="oi oi-list-rich" aria-hidden="true"></span> Fetch data
            </NavLink>
        </div>
    </nav>
</div>

@code {
    private bool collapseNavMenu = true;

    private string? NavMenuCssClass => collapseNavMenu ? "collapse" : null;

    private void ToggleNavMenu()
    {
        collapseNavMenu = !collapseNavMenu;
    }

    private void Logout()
    {
        CompanyContext.ClearCompany();
        Navigation.NavigateTo("/login");
    }

    private string GetCompanyDisplayName()
    {
        if (CompanyContext.CurrentCompany is null)
        {
            return string.Empty;
        }

        return string.IsNullOrWhiteSpace(CompanyContext.CurrentCompany.TradingName)
            ? CompanyContext.CurrentCompany.LegalName
            : CompanyContext.CurrentCompany.TradingName!;
    }
}

<style>
    .pchouse-logo {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-weight: 700;
        font-size: 1.25rem;
        color: var(--pchouse-white) !important;
        text-decoration: none;
        transition: all 0.3s ease;
    }

    .pchouse-logo:hover {
        color: var(--pchouse-accent) !important;
        transform: scale(1.05);
    }

    .pchouse-icon {
        font-size: 1.5rem;
        filter: hue-rotate(200deg) brightness(1.2);
        animation: pulse 2s infinite;
    }

    @@keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); }
    }

    .company-info {
        display: flex;
        align-items: center;
        gap: 10px;
        color: white;
    }

    .company-name {
        font-weight: 500;
        font-size: 14px;
        background: rgba(255, 255, 255, 0.1);
        padding: 0.25rem 0.75rem;
        border-radius: 6px;
        backdrop-filter: blur(10px);
    }

    .btn-logout {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: white;
        padding: 5px 10px;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
    }

    .btn-logout:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateY(-1px);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
</style>
